defaultvalue: Blocks.AIR.defaultBlockState()
scopes:
  local:
    init: ${var.getType().getJavaType(generator.getWorkspace())} ${var.getName()} = ${var.getType().getDefaultValue(generator.getWorkspace())};
    get: /*@BlockState*/${name}
    set: <#include "mcitems.ftl"> ${name} = ${mappedBlockToBlockStateCode(value)};
  global_session:
    init: public static BlockState ${var.getName()} = ${generator.map(var.getValue(), "blocksitems")}.defaultBlockState();
    get: /*@BlockState*/${JavaModName}Variables.${name}
    set: <#include "mcitems.ftl"> ${JavaModName}Variables.${name} = ${mappedBlockToBlockStateCode(value)};
  global_world:
    init: public BlockState ${var.getName()} = ${generator.map(var.getValue(), "blocksitems")}.defaultBlockState();
    read: ${var.getName()} = NbtUtils.readBlockState(BuiltInRegistries.BLOCK.asLookup(), nbt.getCompound("${var.getName()}"));
    write: nbt.put("${var.getName()}", NbtUtils.writeBlockState(${var.getName()}));
    get: /*@BlockState*/${JavaModName}Variables.WorldVariables.get(world).${name}
    set: |
      <#include "mcitems.ftl">
      ${JavaModName}Variables.WorldVariables.get(world).${name} = ${mappedBlockToBlockStateCode(value)};
      <@tail>${JavaModName}Variables.WorldVariables.get(world).markSyncDirty();</@tail>
  global_map:
    init: public BlockState ${var.getName()} = ${generator.map(var.getValue(), "blocksitems")}.defaultBlockState();
    read: ${var.getName()} = NbtUtils.readBlockState(BuiltInRegistries.BLOCK.asLookup(), nbt.getCompound("${var.getName()}"));
    write: nbt.put("${var.getName()}", NbtUtils.writeBlockState(${var.getName()}));
    get: /*@BlockState*/${JavaModName}Variables.MapVariables.get(world).${name}
    set: |
      <#include "mcitems.ftl">
      ${JavaModName}Variables.MapVariables.get(world).${name} = ${mappedBlockToBlockStateCode(value)};
      <@tail>${JavaModName}Variables.MapVariables.get(world).markSyncDirty();</@tail>
  player_lifetime:
    init: public BlockState ${var.getName()} = ${generator.map(var.getValue(), "blocksitems")}.defaultBlockState();
    read: ${var.getName()} = NbtUtils.readBlockState(BuiltInRegistries.BLOCK.asLookup(), nbt.getCompound("${var.getName()}"));
    write: nbt.put("${var.getName()}", NbtUtils.writeBlockState(${var.getName()}));
    get: /*@BlockState*/${entity}.getCapability(${JavaModName}Variables.PLAYER_VARIABLES).orElseGet(${JavaModName}Variables.PlayerVariables::new).${name}
    set: |
      <#include "mcitems.ftl">
      <@head>{${entity}.getCapability(${JavaModName}Variables.PLAYER_VARIABLES).ifPresent(capability -> {</@head>
          capability.${name} = ${mappedBlockToBlockStateCode(value)};
          <@tail>capability.markSyncDirty();
        });
      }</@tail>
  player_persistent:
    init: public BlockState ${var.getName()} = ${generator.map(var.getValue(), "blocksitems")}.defaultBlockState();
    read: ${var.getName()} = NbtUtils.readBlockState(BuiltInRegistries.BLOCK.asLookup(), nbt.getCompound("${var.getName()}"));
    write: nbt.put("${var.getName()}", NbtUtils.writeBlockState(${var.getName()}));
    get: /*@BlockState*/${entity}.getCapability(${JavaModName}Variables.PLAYER_VARIABLES).orElseGet(${JavaModName}Variables.PlayerVariables::new).${name}
    set: |
      <#include "mcitems.ftl">
      <@head>{${entity}.getCapability(${JavaModName}Variables.PLAYER_VARIABLES).ifPresent(capability -> {</@head>
          capability.${name} = ${mappedBlockToBlockStateCode(value)};
          <@tail>capability.markSyncDirty();
        });
      }</@tail>